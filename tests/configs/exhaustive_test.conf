http {
    # Servidor 1: Pruebas generales
    server {
        listen 8080;
        server_name localhost;
        root ./www;
        index index.html;
        client_max_body_size 1000000; # 1MB

        # Error pages personalizadas (Ruta actualizada)
        error_page 404 /errors/404.html;

        location / {
            allow_methods GET POST;
            autoindex on;
        }

        location /tests {
            allow_methods GET POST DELETE;
            autoindex on;
        }

        location /uploads {
            allow_methods GET POST DELETE;
            upload_path ./www/uploads;
            autoindex on;
        }

        location /cgi-bin {
            allow_methods GET POST;
            cgi_ext .py .sh;
            cgi_path /opt/homebrew/bin/python3 /bin/bash;
            autoindex on;
        }

        location /forbidden {
            allow_methods GET;
            # El directorio físico tiene permisos 000
        }

        location /limit_size {
            allow_methods POST;
            client_max_body_size 10; # Solo 10 bytes para probar el 413
        }

        # Prueba de Redirección (301)
        location /google {
            return 301 http://www.google.com;
        }

        # Prueba de 405 Method Not Allowed
        location /only-get {
            allow_methods GET;
            root ./www/tests;
        }
    }

    # Servidor 2: Virtual Hosting (Mismo puerto, diferente nombre)
    server {
        listen 8080;
        server_name example.com;
        root ./www/tests/vhosts;
        index example.html;
    }

    # Servidor 3: Diferente puerto
    server {
        listen 9090;
        server_name localhost;
        root ./www;
        index index.html;

        location / {
            allow_methods GET;
            autoindex on;
        }
    }
}
