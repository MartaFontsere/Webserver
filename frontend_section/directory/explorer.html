<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“‚ Directory Explorer - 42 Webserver</title>
    <link rel="stylesheet" href="../css/directory_styles.css">
</head>

<body>
    <div class="container">
        <!-- HEADER -->
        <header class="explorer-header">
            <div class="header-content">
                <h1>ğŸ“‚ Directory Explorer</h1>
                <p class="subtitle">Navigate and manage server directories with autoindex functionality</p>

                <!-- Navigation -->
                <nav class="nav-links">
                    <a href="../index.html" class="nav-button">ğŸ  Home</a>
                    <a href="../upload/upload.html" class="nav-button">ğŸ“ Upload</a>
                    <a href="../get/test_get.html" class="nav-button">ğŸ“¥ GET</a>
                    <a href="../cgi/test_cgi.html" class="nav-button">âš™ï¸ CGI</a>
                    <a href="../post/test_post.html" class="nav-button">ğŸ“¤ POST</a>
                    <a href="../delete/test_delete.html" class="nav-button">ğŸ—‘ï¸ DELETE</a>
                    <a href="../about.html" class="nav-button">â„¹ï¸ About</a>
                </nav>
            </div>
        </header>

        <!-- MAIN EXPLORER INTERFACE -->
        <main class="explorer-main">

            <!-- 
            ============================================================================
            ğŸ”§ BACKEND INTEGRATION POINT #1: DIRECTORY NAVIGATION
            ============================================================================
            
            FUNCTIONALITY: Directory browsing and autoindex display
            
            REQUIRED BACKEND ENDPOINTS:
            ğŸ“ GET /directory/{path} - List directory contents
            ğŸ“ Response format: JSON array of file/directory objects
            
            EXPECTED RESPONSE:
            {
              "path": "/uploads",
              "items": [
                {
                  "name": "document.pdf",
                  "type": "file",
                  "size": 1024576,
                  "modified": "2024-01-01T12:00:00Z",
                  "permissions": "rw-r--r--",
                  "mime_type": "application/pdf"
                },
                {
                  "name": "images",
                  "type": "directory",
                  "size": null,
                  "modified": "2024-01-01T10:00:00Z",
                  "permissions": "rwxr-xr-x",
                  "items_count": 15
                }
              ]
            }
            
            CURRENT STATE: Ready for backend integration
            ============================================================================
            -->

            <!-- NAVIGATION AND PATH SECTION -->
            <section class="navigation-section">
                <div class="nav-container">
                    <!-- Breadcrumb Navigation -->
                    <div class="breadcrumb-container">
                        <nav class="breadcrumb" aria-label="Directory path">
                            <ol id="breadcrumb-list" class="breadcrumb-list">
                                <li class="breadcrumb-item">
                                    <a href="#" data-path="/" class="breadcrumb-link">ğŸ  Root</a>
                                </li>
                            </ol>
                        </nav>
                    </div>

                    <!-- Navigation Controls -->
                    <div class="nav-controls">
                        <button id="nav-back" class="nav-control-button" title="Go back">â¬…ï¸ Back</button>
                        <button id="nav-forward" class="nav-control-button" title="Go forward">â¡ï¸ Forward</button>
                        <button id="nav-up" class="nav-control-button" title="Go up one level">â¬†ï¸ Up</button>
                        <button id="nav-refresh" class="nav-control-button" title="Refresh current directory">ğŸ”„
                            Refresh</button>
                    </div>

                    <!-- Address Bar -->
                    <div class="address-container">
                        <label for="address-bar" class="address-label">ğŸ“‚ Current Path:</label>
                        <input type="text" id="address-bar" class="address-input" value="/"
                            placeholder="Enter directory path...">
                        <button id="navigate-button" class="navigate-button">â†’ Go</button>
                    </div>
                </div>
            </section>



            <!-- 
            ============================================================================
            ğŸ”§ BACKEND INTEGRATION POINT #2: FILE OPERATIONS
            ============================================================================
            
            FUNCTIONALITY: File download, preview, and basic operations
            
            REQUIRED BACKEND ENDPOINTS:
            ğŸ“ GET /files/{path} - Download file
            ğŸ“ GET /preview/{path} - File preview (images, text)
            ğŸ“ DELETE /files/{path} - Delete file (integration with DELETE module)
            ğŸ“ POST /directory - Create new directory
            
            INTEGRATION NOTES:
            - Download links should point to actual file endpoints
            - Preview functionality for supported file types
            - Delete operations integrate with existing DELETE module
            - Directory creation requires proper permissions
            
            CURRENT STATE: UI ready, awaiting backend endpoints
            ============================================================================
            -->

            <!-- DIRECTORY CONTENT -->
            <section class="content-section">
                <div class="content-container">
                    <!-- Directory Header with integrated controls -->
                    <div class="directory-header">
                        <div class="directory-title-section">
                            <h3 id="current-path-title">ğŸ“‚ /</h3>
                            <div class="directory-stats">
                                <span id="items-count">0 items</span>
                                <span id="total-size">0 B</span>
                            </div>
                        </div>

                        <!-- Integrated View and Filter Controls -->
                        <div class="directory-controls">
                            <div class="view-controls">
                                <div class="view-buttons">
                                    <button id="view-grid" class="view-button active" title="Grid view">âŠ</button>
                                    <button id="view-list" class="view-button" title="List view">â˜°</button>
                                    <button id="view-details" class="view-button" title="Details view">ğŸ“‹</button>
                                </div>
                            </div>

                            <div class="sort-controls">
                                <select id="sort-by" class="sort-select">
                                    <option value="name">ğŸ“ Name</option>
                                    <option value="type">ğŸ“ Type</option>
                                    <option value="size">ğŸ“ Size</option>
                                    <option value="modified">ğŸ“… Modified</option>
                                </select>
                                <button id="sort-order" class="sort-button" data-order="asc"
                                    title="Toggle sort order">â¬†ï¸</button>
                            </div>

                            <div class="filter-controls">
                                <input type="text" id="filter-input" class="filter-input" placeholder="Search files...">
                                <select id="type-filter" class="type-filter">
                                    <option value="all">All</option>
                                    <option value="directory">ğŸ“ Dirs</option>
                                    <option value="file">ğŸ“„ Files</option>
                                    <option value="image">ğŸ–¼ï¸ Images</option>
                                    <option value="document">ğŸ“‹ Docs</option>
                                    <option value="archive">ğŸ“¦ Archives</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="loading-state" class="loading-state hidden">
                        <div class="loading-spinner"></div>
                        <p>Loading directory contents...</p>
                    </div>

                    <!-- Empty State -->
                    <div id="empty-state" class="empty-state hidden">
                        <div class="empty-icon">ğŸ“­</div>
                        <h3>Empty Directory</h3>
                        <p>This directory contains no files or subdirectories.</p>
                    </div>

                    <!-- Error State -->
                    <div id="error-state" class="error-state hidden">
                        <div class="error-icon">âŒ</div>
                        <h3>Unable to Load Directory</h3>
                        <p id="error-message">An error occurred while loading the directory contents.</p>
                        <button id="retry-button" class="retry-button">ğŸ”„ Retry</button>
                    </div>

                    <!-- Directory Listing -->
                    <div id="directory-listing" class="directory-listing view-grid">
                        <!-- Items will be populated by JavaScript -->
                    </div>
                </div>
            </section>

            <!-- 
            ============================================================================
            ğŸ”§ BACKEND INTEGRATION POINT #3: CONTEXT MENU AND ACTIONS
            ============================================================================
            
            FUNCTIONALITY: Right-click context menu with file operations
            
            AVAILABLE ACTIONS:
            ğŸ“ Download - GET /files/{path}
            ğŸ“ Preview - GET /preview/{path} or inline preview for supported types
            ğŸ“ Delete - DELETE /files/{path} (uses existing DELETE module)
            ğŸ“ Rename - PUT /files/{old_path} with new name
            ğŸ“ Copy - POST /files/copy with source and destination
            ğŸ“ Move - PUT /files/{path} with new location
            ğŸ“ Properties - GET /files/{path}/info for detailed file information
            
            INTEGRATION:
            - Context menu appears on right-click
            - Actions execute appropriate backend calls
            - Integration with existing modules (DELETE, etc.)
            - Progress feedback for long operations
            
            CURRENT STATE: Context menu implemented, backend integration pending
            ============================================================================
            -->

            <!-- CONTEXT MENU -->
            <div id="context-menu" class="context-menu hidden">
                <ul class="context-menu-list">
                    <li class="context-menu-item" data-action="download">
                        <span class="context-icon">ğŸ“¥</span>
                        <span class="context-text">Download</span>
                    </li>
                    <li class="context-menu-item" data-action="preview">
                        <span class="context-icon">ğŸ‘ï¸</span>
                        <span class="context-text">Preview</span>
                    </li>
                    <li class="context-menu-separator"></li>
                    <li class="context-menu-item" data-action="rename">
                        <span class="context-icon">âœï¸</span>
                        <span class="context-text">Rename</span>
                    </li>
                    <li class="context-menu-item" data-action="copy">
                        <span class="context-icon">ğŸ“‹</span>
                        <span class="context-text">Copy</span>
                    </li>
                    <li class="context-menu-item" data-action="move">
                        <span class="context-icon">âœ‚ï¸</span>
                        <span class="context-text">Move</span>
                    </li>
                    <li class="context-menu-separator"></li>
                    <li class="context-menu-item" data-action="properties">
                        <span class="context-icon">â„¹ï¸</span>
                        <span class="context-text">Properties</span>
                    </li>
                    <li class="context-menu-item" data-action="delete">
                        <span class="context-icon">ğŸ—‘ï¸</span>
                        <span class="context-text">Delete</span>
                    </li>
                </ul>
            </div>

            <!-- PREVIEW MODAL -->
            <div id="preview-modal" class="preview-modal hidden">
                <div class="preview-overlay"></div>
                <div class="preview-container">
                    <div class="preview-header">
                        <h3 id="preview-title">File Preview</h3>
                        <button id="preview-close" class="preview-close">âœ•</button>
                    </div>
                    <div class="preview-content" id="preview-content">
                        <!-- Preview content will be populated by JavaScript -->
                    </div>
                    <div class="preview-actions">
                        <button id="preview-download" class="preview-action-button">ğŸ“¥ Download</button>
                        <button id="preview-fullscreen" class="preview-action-button">ğŸ” Fullscreen</button>
                    </div>
                </div>
            </div>

        </main>

        <!-- FOOTER -->
        <footer>
            <p>Â© 2025 - Directory Explorer Module | 42 Barcelona Webserver Project</p>
            <p>Developed with â¤ï¸ and lots of â˜•</p>
        </footer>
    </div>

    <!-- JavaScript Modules -->
    <script src="js/directory_config.js"></script>
    <script src="js/directory_utils.js"></script>
    <script src="js/directory_handlers.js"></script>
    <script src="js/directory_navigation.js"></script>
    <script src="js/directory_main.js"></script>
</body>

</html>